## Vendor files directory

The contents of this directory are automatically generated by moving some of the packages in the `vendor` directory and prefixing the namespace of their classes with `Automattic\WooCommerce\Internal\Vendor`, right after `composer install/update` finishes. This is done to prevent conflicts with plugins using the same packages.

**Do no** make manual changes in the files here. Such changes will be lost the next time the contents are regenerated.

### Registering packages to be moved

If you want to register a vendor package for being moved to the `Automattic\WooCommerce\Internal\Vendor` namespace in order to avoid possible namespace conflicts, follow these steps:

1. Add the package to the `require-dev` section in `composer.json`. If the package was already listed in `require`, remove it.

2. Add the package to the `extra/mozart/packages` section in `composer.json` too, note that this time you add only the package slug (not the version).

3. Run `composer update`.

4. Run `composer run move-vendor-packages`.

5. Notice that a new folder `VendorName/PackageName` has been added to `src/Internal/Vendor`. Add it to source control.

6. All the namespaces in the moved code will have been prefixed with `Automattic\WooCommerce\Internal\Vendor`, so if you already had code that made use of the package, you'll need to adjust it accordingly.

The `composer run move-vendor-packages` command uses the [coenjacobs/mozart](https://github.com/coenjacobs/mozart) package, which requires PHP 7.2 or newer.

### Updating packages

If you want to update any of the moved packages to a new version, repeat steps 3 to 5 above.

### Preventing a dependency from being moved

If you want to prevent a package dependency from being moved and thus re-namespaced (for example, we use a moved `league/container` package but it has a dependency on `psr/container` which we don't want to be moved) you need to follow these additional steps after 2 above:

2.1. Add the dependency to the `require` section in `composer.json`. Yes, this time it's `require`, not `require-dev`.

2.2. Add the dependency to the `extra/mozart/excluded-packages` section in `composer.json` too (again, the slug only).

### Why adding the packages to be moved to require-dev?

Once a package has been moved it's no longer needed in the `vendor` directory, so we don't want it to be there when we build WooCommerce into a zip file (we want that zip file to be as small as possible).

Fortunately, the `npm run build` command executes `composer install --no-dev` before generating the zip file. Therefore, by adding the package to `require-dev` we make sure that the package will not be present in the `vendor` directory in the generated zip. 

The package will still be in `vendor` when you run `composer update/install` in your development environment, but you are free to just ignore it. Note that `composer run move-vendor-packages` will effectively remove the package from `vendor`, but that's not a command you will normally need to run.

  
