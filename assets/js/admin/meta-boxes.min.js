jQuery(function(e){function t(){e("#tiptip_holder").removeAttr("style");e("#tiptip_arrow").removeAttr("style");e(".tips").tipTip({attribute:"data-tip",fadeIn:50,fadeOut:50,delay:200})}function n(){var t=e("select#product-type").val();var n=e("input#_virtual:checked").size();var r=e("input#_downloadable:checked").size();var i=".hide_if_downloadable, .hide_if_virtual";var s=".show_if_downloadable, .show_if_virtual, .show_if_external";e.each(woocommerce_admin_meta_boxes.product_types,function(e,t){i=i+", .hide_if_"+t;s=s+", .show_if_"+t});e(i).show();e(s).hide();if(r){e(".show_if_downloadable").show()}if(n){e(".show_if_virtual").show()}e(".show_if_"+t).show();if(r){e(".hide_if_downloadable").hide()}if(n){e(".hide_if_virtual").hide()}e(".hide_if_"+t).hide();e("input#_manage_stock").change()}function s(){e(".product_attributes .woocommerce_attribute").each(function(t,n){e(".attribute_position",n).val(parseInt(e(n).index(".product_attributes .woocommerce_attribute")))})}e("#titlediv #title").keyup(function(t){var n=t.keyCode||t.which;if(n=="9"&&e("#woocommerce-coupon-description").size()>0){t.stopPropagation();e("#woocommerce-coupon-description").focus();return false}});e("select#discount_type").change(function(){var t=e(this).val();if(t=="fixed_product"||t=="percent_product"){e(".limit_usage_to_x_items_field").show()}else{e(".limit_usage_to_x_items_field").hide()}}).change();e(function(){e('[id$="-all"] > ul.categorychecklist').each(function(){var t=e(this);var n=t.find(":checked").first();if(!n.length)return;var r=t.find("input").position().top;var i=n.position().top;t.closest(".tabs-panel").scrollTop(i-r+5)})});e("#upsell_product_data").bind("keypress",function(e){if(e.keyCode==13)return false});e(".type_box").appendTo("#woocommerce-product-data h3.hndle span");e(function(){e("#woocommerce-product-data h3.hndle").unbind("click.postboxes");jQuery("#woocommerce-product-data").on("click","h3.hndle",function(t){if(e(t.target).filter("input, option, label, select").length)return;e("#woocommerce-product-data").toggleClass("closed")})});e(function(){jQuery(".wc-metabox > h3").click(function(t){e(this).parent(".wc-metabox").toggleClass("closed").toggleClass("open")})});e("#order-emails a.show-order-emails").click(function(){if(e("#order-emails-select").is(":hidden")){e("#order-emails-select").slideDown("fast");e(this).hide()}return false});e("#order-emails a.hide-order-emails").click(function(){e('input[name="order_email[]"]').each(function(){e(this).attr("checked",false)});if(e("#order-emails-select").is(":visible")){e("#order-emails-select").slideUp("fast");e("#order-emails a.show-order-emails").show()}return false});e("#catalog-visibility .edit-catalog-visibility").click(function(){if(e("#catalog-visibility-select").is(":hidden")){e("#catalog-visibility-select").slideDown("fast");e(this).hide()}return false});e("#catalog-visibility .save-post-visibility").click(function(){e("#catalog-visibility-select").slideUp("fast");e("#catalog-visibility .edit-catalog-visibility").show();var t=e("input[name=_visibility]:checked").val();var n=e("input[name=_visibility]:checked").attr("data-label");if(e("input[name=_featured]").is(":checked")){n=n+", "+woocommerce_admin_meta_boxes.featured_label;e("input[name=_featured]").attr("checked","checked")}e("#catalog-visibility-display").text(n);return false});e("#catalog-visibility .cancel-post-visibility").click(function(){e("#catalog-visibility-select").slideUp("fast");e("#catalog-visibility .edit-catalog-visibility").show();var t=e("#current_visibility").val();var n=e("#current_featured").val();e("input[name=_visibility]").removeAttr("checked");e("input[name=_visibility][value="+t+"]").attr("checked","checked");var r=e("input[name=_visibility]:checked").attr("data-label");if(n=="yes"){r=r+", "+woocommerce_admin_meta_boxes.featured_label;e("input[name=_featured]").attr("checked","checked")}else{e("input[name=_featured]").removeAttr("checked")}e("#catalog-visibility-display").text(r);return false});e("ul.wc-tabs").show();e("div.panel-wrap").each(function(){e(this).find("div.panel:not(:first)").hide()});e("ul.wc-tabs a").click(function(){var t=e(this).closest("div.panel-wrap");e("ul.wc-tabs li",t).removeClass("active");e(this).parent().addClass("active");e("div.panel",t).hide();e(e(this).attr("href")).show();return false});jQuery("select.chosen_select").chosen();jQuery("select.chosen_select_nostd").chosen({allow_single_deselect:"true"});jQuery("select.ajax_chosen_select_products").ajaxChosen({method:"GET",url:woocommerce_admin_meta_boxes.ajax_url,dataType:"json",afterTypeDelay:100,data:{action:"woocommerce_json_search_products",security:woocommerce_admin_meta_boxes.search_products_nonce}},function(t){var n={};e.each(t,function(e,t){n[e]=t});return n});jQuery("select.ajax_chosen_select_products_and_variations").ajaxChosen({method:"GET",url:woocommerce_admin_meta_boxes.ajax_url,dataType:"json",afterTypeDelay:100,data:{action:"woocommerce_json_search_products_and_variations",security:woocommerce_admin_meta_boxes.search_products_nonce}},function(t){var n={};e.each(t,function(e,t){n[e]=t});return n});jQuery("select.ajax_chosen_select_downloadable_products_and_variations").ajaxChosen({method:"GET",url:woocommerce_admin_meta_boxes.ajax_url,dataType:"json",afterTypeDelay:100,data:{action:"woocommerce_json_search_downloadable_products_and_variations",security:woocommerce_admin_meta_boxes.search_products_nonce}},function(t){var n={};e.each(t,function(e,t){n[e]=t});return n});jQuery("#woocommerce-order-actions input, #woocommerce-order-actions a").click(function(){window.onbeforeunload=""});e("a.edit_address").click(function(t){e(this).hide();e(this).closest(".order_data_column").find("div.address").hide();e(this).closest(".order_data_column").find("div.edit_address").show();t.preventDefault()});e("#order_items_list").on("init_row","tr.item",function(){var t=e(this);var n=t.find("input.quantity");var r=n.val();var i=accounting.unformat(t.find("input.line_subtotal").val(),woocommerce_admin.mon_decimal_point);var s=accounting.unformat(t.find("input.line_total").val(),woocommerce_admin.mon_decimal_point);var o=accounting.unformat(t.find("input.line_tax").val(),woocommerce_admin.mon_decimal_point);var u=accounting.unformat(t.find("input.line_subtotal_tax").val(),woocommerce_admin.mon_decimal_point);if(r){unit_subtotal=parseFloat(accounting.toFixed(i/r,woocommerce_admin_meta_boxes.rounding_precision));unit_subtotal_tax=parseFloat(accounting.toFixed(u/r,woocommerce_admin_meta_boxes.rounding_precision));unit_total=parseFloat(accounting.toFixed(s/r,woocommerce_admin_meta_boxes.rounding_precision));unit_total_tax=parseFloat(accounting.toFixed(o/r,woocommerce_admin_meta_boxes.rounding_precision))}else{unit_subtotal=unit_subtotal_tax=unit_total=unit_total_tax=0}n.attr("data-o_qty",r);t.attr("data-unit_subtotal",unit_subtotal);t.attr("data-unit_subtotal_tax",unit_subtotal_tax);t.attr("data-unit_total",unit_total);t.attr("data-unit_total_tax",unit_total_tax)});e("#order_items_list tr.item").each(function(){e(this).trigger("init_row");e(this).find(".edit").hide()});e("#order_items_list").on("click","a.edit_order_item",function(){e(this).closest("tr").find(".view").hide();e(this).closest("tr").find(".edit").show();e(this).hide();return false});e("#order_items_list").on("change","input.quantity",function(){var t=e(this).closest("tr.item");var n=e(this).val();var r=t.attr("data-unit_subtotal");var i=t.attr("data-unit_subtotal_tax");var s=t.attr("data-unit_total");var o=t.attr("data-unit_total_tax");var u=e(this).attr("data-o_qty");var a=parseFloat(accounting.formatNumber(r*n,woocommerce_admin_meta_boxes.rounding_precision,""));var f=parseFloat(accounting.formatNumber(i*n,woocommerce_admin_meta_boxes.rounding_precision,""));var l=parseFloat(accounting.formatNumber(s*n,woocommerce_admin_meta_boxes.rounding_precision,""));var c=parseFloat(accounting.formatNumber(o*n,woocommerce_admin_meta_boxes.rounding_precision,""));a=a.toString().replace(".",woocommerce_admin.mon_decimal_point);f=f.toString().replace(".",woocommerce_admin.mon_decimal_point);l=l.toString().replace(".",woocommerce_admin.mon_decimal_point);c=c.toString().replace(".",woocommerce_admin.mon_decimal_point);t.find("input.line_subtotal").val(a);t.find("input.line_total").val(l);t.find("input.line_subtotal_tax").val(f);t.find("input.line_tax").val(c);e(this).trigger("quantity_changed")});e("#order_items_list").on("change","input.line_subtotal",function(){var t=e(this).closest("tr.item");var n=t.find("input.quantity");var r=n.val();var i=r?accounting.toFixed(e(this).val()/r,woocommerce_admin_meta_boxes.rounding_precision):0;t.attr("data-unit_subtotal",i)});e("#order_items_list").on("change","input.line_total",function(){var t=e(this).closest("tr.item");var n=t.find("input.quantity");var r=n.val();var i=r?accounting.toFixed(e(this).val()/r,woocommerce_admin_meta_boxes.rounding_precision):0;t.attr("data-unit_total",i)});e("#order_items_list").on("change","input.line_subtotal_tax",function(){var t=e(this).closest("tr.item");var n=t.find("input.quantity");var r=n.val();var i=r?accounting.toFixed(e(this).val()/r,woocommerce_admin_meta_boxes.rounding_precision):0;t.attr("data-unit_subtotal_tax",i)});e("#order_items_list").on("change","input.line_tax",function(){var t=e(this).closest("tr.item");var n=t.find("input.quantity");var r=n.val();var i=r?accounting.toFixed(e(this).val()/r,woocommerce_admin_meta_boxes.rounding_precision):0;t.attr("data-unit_total_tax",i)});e("#woocommerce-order-totals").on("change input",".order_taxes_amount, .order_taxes_shipping_amount, .shipping_cost, #_order_discount",function(){var t=e(this);var n=t.closest(".totals_group").find("input[type=number], .wc_input_price");var r=0;n.each(function(){if(e(this).val())r=r+accounting.unformat(e(this).val(),woocommerce_admin.mon_decimal_point)});if(t.is(".order_taxes_amount")||t.is(".order_taxes_shipping_amount")){r=round(r,woocommerce_admin_meta_boxes.currency_format_num_decimals,woocommerce_admin_meta_boxes.tax_rounding_mode)}var i=accounting.formatMoney(r,{symbol:woocommerce_admin_meta_boxes.currency_format_symbol,decimal:woocommerce_admin_meta_boxes.currency_format_decimal_sep,thousand:woocommerce_admin_meta_boxes.currency_format_thousand_sep,precision:woocommerce_admin_meta_boxes.currency_format_num_decimals,format:woocommerce_admin_meta_boxes.currency_format});t.closest(".totals_group").find("span.inline_total").text(i)});e("span.inline_total").closest(".totals_group").find("input").change();e("button.calc_line_taxes").click(function(){e(".woocommerce_order_items_wrapper").block({message:null,overlayCSS:{background:"#fff url("+woocommerce_admin_meta_boxes.plugin_url+"/assets/images/ajax-loader.gif) no-repeat center",opacity:.6}});var t=confirm(woocommerce_admin_meta_boxes.calc_line_taxes);if(t){var n=e("#order_items_list").find("tr.item, tr.fee");var r=e("#_shipping_country").val();var i=e("#_billing_country").val();if(r){var s=r;var o=e("#_shipping_state").val();var u=e("#_shipping_postcode").val();var a=e("#_shipping_city").val()}else if(i){var s=i;var o=e("#_billing_state").val();var u=e("#_billing_postcode").val();var a=e("#_billing_city").val()}else{var s=woocommerce_admin_meta_boxes.base_country;var o="";var u="";var a=""}var f={};n.each(function(){var t=e(this);var n=t.find("input.order_item_id").val();var r=t.find("input.line_subtotal").val();var i=t.find("input.line_total").val();var s=t.find("select.tax_class").val();f[n]={};f[n].line_subtotal=r;f[n].line_total=i;f[n].tax_class=s});order_shipping=0;e("#shipping_rows").find("input[type=number], .wc_input_price").each(function(){cost=e(this).val()||"0";cost=accounting.unformat(cost,woocommerce_admin.mon_decimal_point);order_shipping=order_shipping+parseFloat(cost)});var l={action:"woocommerce_calc_line_taxes",order_id:woocommerce_admin_meta_boxes.post_id,items:f,shipping:order_shipping,country:s,state:o,postcode:u,city:a,security:woocommerce_admin_meta_boxes.calc_totals_nonce};e.post(woocommerce_admin_meta_boxes.ajax_url,l,function(t){if(t){n.each(function(){var n=e(this);var r=n.find("input.order_item_id").val();n.find(".edit_order_item").click();if(t["item_taxes"][r]){n.find("input.line_tax").val(t["item_taxes"][r]["line_tax"]).change();n.find("input.line_subtotal_tax").val(t["item_taxes"][r]["line_subtotal_tax"]).change()}if(t["tax_row_html"])e("#tax_rows").empty().append(t["tax_row_html"])});e("#tax_rows").find("input").change()}e(".woocommerce_order_items_wrapper").unblock()})}else{e(".woocommerce_order_items_wrapper").unblock()}return false});e("button.calc_totals").click(function(){e("#woocommerce-order-totals").block({message:null,overlayCSS:{background:"#fff url("+woocommerce_admin_meta_boxes.plugin_url+"/assets/images/ajax-loader.gif) no-repeat center",opacity:.6}});var t=confirm(woocommerce_admin_meta_boxes.calc_totals);if(t){var n=0;var r=0;var i=0;var s=e("#_order_discount").val()||"0";s=accounting.unformat(s.replace(",","."));e("#shipping_rows").find("input[type=number], .wc_input_price").each(function(){cost=e(this).val()||"0";cost=accounting.unformat(cost,woocommerce_admin.mon_decimal_point);i=i+parseFloat(cost)});e("#tax_rows").find("input[type=number], .wc_input_price").each(function(){cost=e(this).val()||"0";cost=accounting.unformat(cost,woocommerce_admin.mon_decimal_point);r=r+parseFloat(cost)});e("#order_items_list tr.item, #order_items_list tr.fee").each(function(){line_total=e(this).find("input.line_total").val()||"0";n=n+accounting.unformat(line_total.replace(",","."))});if(woocommerce_admin_meta_boxes.round_at_subtotal=="yes")r=parseFloat(accounting.toFixed(r,woocommerce_admin_meta_boxes.rounding_precision));e("#_order_total").val(accounting.formatNumber(n+r+i-s,woocommerce_admin_meta_boxes.currency_format_num_decimals,"",woocommerce_admin.mon_decimal_point)).change()}e("#woocommerce-order-totals").unblock();return false});e("#woocommerce-order-items button.add_order_item").click(function(){var n=e("select#add_item_id").val();if(n){count=n.length;e("table.woocommerce_order_items").block({message:null,overlayCSS:{background:"#fff url("+woocommerce_admin_meta_boxes.plugin_url+"/assets/images/ajax-loader.gif) no-repeat center",opacity:.6}});e.each(n,function(n,r){var i={action:"woocommerce_add_order_item",item_to_add:r,order_id:woocommerce_admin_meta_boxes.post_id,security:woocommerce_admin_meta_boxes.order_item_nonce};e.post(woocommerce_admin_meta_boxes.ajax_url,i,function(n){e("table.woocommerce_order_items tbody#order_items_list").append(n);if(!--count){e("select#add_item_id, #add_item_id_chosen .chosen-choices").css("border-color","").val("");t();e("select#add_item_id").trigger("chosen:updated");e("table.woocommerce_order_items").unblock()}e("#order_items_list tr.new_row").trigger("init_row").removeClass("new_row")})})}else{e("select#add_item_id, #add_item_id_chosen .chosen-choices").css("border-color","red")}return false});e("#woocommerce-order-items button.add_order_fee").click(function(){e("table.woocommerce_order_items").block({message:null,overlayCSS:{background:"#fff url("+woocommerce_admin_meta_boxes.plugin_url+"/assets/images/ajax-loader.gif) no-repeat center",opacity:.6}});var t={action:"woocommerce_add_order_fee",order_id:woocommerce_admin_meta_boxes.post_id,security:woocommerce_admin_meta_boxes.order_item_nonce};e.post(woocommerce_admin_meta_boxes.ajax_url,t,function(t){e("table.woocommerce_order_items tbody#order_items_list").append(t);e("table.woocommerce_order_items").unblock()});return false});e("#order_items_list").on("click","button.add_order_item_meta",function(){var t=e(this);var n=t.closest("tr.item");var r={order_item_id:n.attr("data-order_item_id"),action:"woocommerce_add_order_item_meta",security:woocommerce_admin_meta_boxes.order_item_nonce};e("table.woocommerce_order_items").block({message:null,overlayCSS:{background:"#fff url("+woocommerce_admin_meta_boxes.plugin_url+"/assets/images/ajax-loader.gif) no-repeat center",opacity:.6}});e.ajax({url:woocommerce_admin_meta_boxes.ajax_url,data:r,type:"POST",success:function(t){n.find("tbody.meta_items").append(t);e("table.woocommerce_order_items").unblock()}});return false});e("#order_items_list").on("click","button.remove_order_item_meta",function(){var t=confirm(woocommerce_admin_meta_boxes.remove_item_meta);if(t){var n=e(this).closest("tr");var r={meta_id:n.attr("data-meta_id"),action:"woocommerce_remove_order_item_meta",security:woocommerce_admin_meta_boxes.order_item_nonce};e("table.woocommerce_order_items").block({message:null,overlayCSS:{background:"#fff url("+woocommerce_admin_meta_boxes.plugin_url+"/assets/images/ajax-loader.gif) no-repeat center",opacity:.6}});e.ajax({url:woocommerce_admin_meta_boxes.ajax_url,data:r,type:"POST",success:function(t){n.hide();e("table.woocommerce_order_items").unblock()}})}return false});e("#woocommerce-order-items").on("click","input.check-column",function(){if(e(this).is(":checked"))e("#woocommerce-order-items").find(".check-column input").attr("checked","checked");else e("#woocommerce-order-items").find(".check-column input").removeAttr("checked")});e("#woocommerce-order-items").on("click",".do_bulk_action",function(){var t=e(this).closest(".bulk_actions").find("select").val();var n=e("#woocommerce-order-items").find(".check-column input:checked");var r=[];e(n).each(function(){var t=e(this).closest("tr.item, tr.fee");r.push(t.attr("data-order_item_id"))});if(r.length==0){alert(woocommerce_admin_meta_boxes.i18n_select_items);return}if(t=="delete"){var i=confirm(woocommerce_admin_meta_boxes.remove_item_notice);if(i){e("table.woocommerce_order_items").block({message:null,overlayCSS:{background:"#fff url("+woocommerce_admin_meta_boxes.plugin_url+"/assets/images/ajax-loader.gif) no-repeat center",opacity:.6}});var s={order_item_ids:r,action:"woocommerce_remove_order_item",security:woocommerce_admin_meta_boxes.order_item_nonce};e.ajax({url:woocommerce_admin_meta_boxes.ajax_url,data:s,type:"POST",success:function(t){e(n).each(function(){e(this).closest("tr.item, tr.fee").remove()});e("table.woocommerce_order_items").unblock()}})}}else if(t=="reduce_stock"){e("table.woocommerce_order_items").block({message:null,overlayCSS:{background:"#fff url("+woocommerce_admin_meta_boxes.plugin_url+"/assets/images/ajax-loader.gif) no-repeat center",opacity:.6}});var o={};e(n).each(function(){var t=e(this).closest("tr.item, tr.fee");var n=t.find("input.quantity");o[t.attr("data-order_item_id")]=n.val()});var s={order_id:woocommerce_admin_meta_boxes.post_id,order_item_ids:r,order_item_qty:o,action:"woocommerce_reduce_order_item_stock",security:woocommerce_admin_meta_boxes.order_item_nonce};e.ajax({url:woocommerce_admin_meta_boxes.ajax_url,data:s,type:"POST",success:function(t){alert(t);e("table.woocommerce_order_items").unblock()}})}else if(t=="increase_stock"){e("table.woocommerce_order_items").block({message:null,overlayCSS:{background:"#fff url("+woocommerce_admin_meta_boxes.plugin_url+"/assets/images/ajax-loader.gif) no-repeat center",opacity:.6}});var o={};e(n).each(function(){var t=e(this).closest("tr.item, tr.fee");var n=t.find("input.quantity");o[t.attr("data-order_item_id")]=n.val()});var s={order_id:woocommerce_admin_meta_boxes.post_id,order_item_ids:r,order_item_qty:o,action:"woocommerce_increase_order_item_stock",security:woocommerce_admin_meta_boxes.order_item_nonce};e.ajax({url:woocommerce_admin_meta_boxes.ajax_url,data:s,type:"POST",success:function(t){alert(t);e("table.woocommerce_order_items").unblock()}})}return false});e(".order_download_permissions").on("click","button.grant_access",function(){var t=e("select#grant_access_id").val();if(!t)return;e(".order_download_permissions").block({message:null,overlayCSS:{background:"#fff url("+woocommerce_admin_meta_boxes.plugin_url+"/assets/images/ajax-loader.gif) no-repeat center",opacity:.6}});var n={action:"woocommerce_grant_access_to_download",product_ids:t,loop:e(".order_download_permissions .wc-metabox").size(),order_id:woocommerce_admin_meta_boxes.post_id,security:woocommerce_admin_meta_boxes.grant_access_nonce};e.post(woocommerce_admin_meta_boxes.ajax_url,n,function(t){if(t){e(".order_download_permissions .wc-metaboxes").append(t)}else{alert(woocommerce_admin_meta_boxes.i18n_download_permission_fail)}e(".date-picker").datepicker({dateFormat:"yy-mm-dd",numberOfMonths:1,showButtonPanel:true,showOn:"button",buttonImage:woocommerce_admin_meta_boxes.calendar_image,buttonImageOnly:true});e("#grant_access_id").val("").trigger("chosen:updated");e(".order_download_permissions").unblock()});return false});e(".order_download_permissions").on("click","button.revoke_access",function(t){t.preventDefault();var n=confirm(woocommerce_admin_meta_boxes.i18n_permission_revoke);if(n){var r=e(this).parent().parent();var i=e(this).attr("rel").split(",")[0];var s=e(this).attr("rel").split(",")[1];if(i>0){e(r).block({message:null,overlayCSS:{background:"#fff url("+woocommerce_admin_meta_boxes.plugin_url+"/assets/images/ajax-loader.gif) no-repeat center",opacity:.6}});var o={action:"woocommerce_revoke_access_to_download",product_id:i,download_id:s,order_id:woocommerce_admin_meta_boxes.post_id,security:woocommerce_admin_meta_boxes.revoke_access_nonce};e.post(woocommerce_admin_meta_boxes.ajax_url,o,function(t){e(r).fadeOut("300",function(){e(r).remove()})})}else{e(r).fadeOut("300",function(){e(r).remove()})}}return false});e("button.load_customer_billing").click(function(){var t=confirm(woocommerce_admin_meta_boxes.load_billing);if(t){var n=e("#customer_user").val();if(!n){alert(woocommerce_admin_meta_boxes.no_customer_selected);return false}var r={user_id:n,type_to_load:"billing",action:"woocommerce_get_customer_details",security:woocommerce_admin_meta_boxes.get_customer_details_nonce};e(this).closest(".edit_address").block({message:null,overlayCSS:{background:"#fff url("+woocommerce_admin_meta_boxes.plugin_url+"/assets/images/ajax-loader.gif) no-repeat center",opacity:.6}});e.ajax({url:woocommerce_admin_meta_boxes.ajax_url,data:r,type:"POST",success:function(t){var n=t;if(n){e("input#_billing_first_name").val(n.billing_first_name);e("input#_billing_last_name").val(n.billing_last_name);e("input#_billing_company").val(n.billing_company);e("input#_billing_address_1").val(n.billing_address_1);e("input#_billing_address_2").val(n.billing_address_2);e("input#_billing_city").val(n.billing_city);e("input#_billing_postcode").val(n.billing_postcode);e("#_billing_country").val(n.billing_country);e("input#_billing_state").val(n.billing_state);e("input#_billing_email").val(n.billing_email);e("input#_billing_phone").val(n.billing_phone)}e(".edit_address").unblock()}})}return false});e("button.load_customer_shipping").click(function(){var t=confirm(woocommerce_admin_meta_boxes.load_shipping);if(t){var n=e("#customer_user").val();if(!n){alert(woocommerce_admin_meta_boxes.no_customer_selected);return false}var r={user_id:n,type_to_load:"shipping",action:"woocommerce_get_customer_details",security:woocommerce_admin_meta_boxes.get_customer_details_nonce};e(this).closest(".edit_address").block({message:null,overlayCSS:{background:"#fff url("+woocommerce_admin_meta_boxes.plugin_url+"/assets/images/ajax-loader.gif) no-repeat center",opacity:.6}});e.ajax({url:woocommerce_admin_meta_boxes.ajax_url,data:r,type:"POST",success:function(t){var n=t;if(n){e("input#_shipping_first_name").val(n.shipping_first_name);e("input#_shipping_last_name").val(n.shipping_last_name);e("input#_shipping_company").val(n.shipping_company);e("input#_shipping_address_1").val(n.shipping_address_1);e("input#_shipping_address_2").val(n.shipping_address_2);e("input#_shipping_city").val(n.shipping_city);e("input#_shipping_postcode").val(n.shipping_postcode);e("#_shipping_country").val(n.shipping_country);e("input#_shipping_state").val(n.shipping_state)}e(".edit_address").unblock()}})}return false});e("button.billing-same-as-shipping").click(function(){var t=confirm(woocommerce_admin_meta_boxes.copy_billing);if(t){e("input#_shipping_first_name").val(e("input#_billing_first_name").val());e("input#_shipping_last_name").val(e("input#_billing_last_name").val());e("input#_shipping_company").val(e("input#_billing_company").val());e("input#_shipping_address_1").val(e("input#_billing_address_1").val());e("input#_shipping_address_2").val(e("input#_billing_address_2").val());e("input#_shipping_city").val(e("input#_billing_city").val());e("input#_shipping_postcode").val(e("input#_billing_postcode").val());e("#_shipping_country").val(e("#_billing_country").val());e("input#_shipping_state").val(e("input#_billing_state").val())}return false});e(".totals_group").on("click","a.add_total_row",function(){e(this).closest(".totals_group").find(".total_rows").append(e(this).data("row"));return false});e(".total_rows").on("click","a.delete_total_row",function(){$row=e(this).closest(".total_row");var t=$row.attr("data-order_item_id");if(t){$row.append('<input type="hidden" name="delete_order_item_id[]" value="'+t+'" />').hide()}else{$row.remove()}return false});e("#woocommerce-order-notes").on("click","a.add_note",function(){if(!e("textarea#add_order_note").val())return;e("#woocommerce-order-notes").block({message:null,overlayCSS:{background:"#fff url("+woocommerce_admin_meta_boxes.plugin_url+"/assets/images/ajax-loader.gif) no-repeat center",opacity:.6}});var t={action:"woocommerce_add_order_note",post_id:woocommerce_admin_meta_boxes.post_id,note:e("textarea#add_order_note").val(),note_type:e("select#order_note_type").val(),security:woocommerce_admin_meta_boxes.add_order_note_nonce};e.post(woocommerce_admin_meta_boxes.ajax_url,t,function(t){e("ul.order_notes").prepend(t);e("#woocommerce-order-notes").unblock();e("#add_order_note").val("")});return false});e("#woocommerce-order-notes").on("click","a.delete_note",function(){var t=e(this).closest("li.note");e(t).block({message:null,overlayCSS:{background:"#fff url("+woocommerce_admin_meta_boxes.plugin_url+"/assets/images/ajax-loader.gif) no-repeat center",opacity:.6}});var n={action:"woocommerce_delete_order_note",note_id:e(t).attr("rel"),security:woocommerce_admin_meta_boxes.delete_order_note_nonce};e.post(woocommerce_admin_meta_boxes.ajax_url,n,function(n){e(t).remove()});return false});e("select#product-type").change(function(){var t=e(this).val();if(t=="variable"){e("input#_manage_stock").change();e("input#_downloadable").prop("checked",false);e("input#_virtual").removeAttr("checked")}else if(t=="grouped"){e("input#_downloadable").prop("checked",false);e("input#_virtual").removeAttr("checked")}else if(t=="external"){e("input#_downloadable").prop("checked",false);e("input#_virtual").removeAttr("checked")}n();e("ul.wc-tabs li:visible").eq(0).find("a").click();e("body").trigger("woocommerce-product-type-change",t,e(this))}).change();e("ul.wc-tabs li:visible").eq(0).find("a").click();e("input#_downloadable, input#_virtual").change(function(){n()});e(".sale_price_dates_fields").each(function(){var t=e(this);var n=false;var r=t.closest("div, table");t.find("input").each(function(){if(e(this).val()!="")n=true});if(n){r.find(".sale_schedule").hide();r.find(".sale_price_dates_fields").show()}else{r.find(".sale_schedule").show();r.find(".sale_price_dates_fields").hide()}});e("#woocommerce-product-data").on("click",".sale_schedule",function(){var t=e(this).closest("div, table");e(this).hide();t.find(".cancel_sale_schedule").show();t.find(".sale_price_dates_fields").show();return false});e("#woocommerce-product-data").on("click",".cancel_sale_schedule",function(){var t=e(this).closest("div, table");e(this).hide();t.find(".sale_schedule").show();t.find(".sale_price_dates_fields").hide();t.find(".sale_price_dates_fields").find("input").val("");return false});e("#woocommerce-product-data").on("click",".downloadable_files a.insert",function(){e(this).closest(".downloadable_files").find("tbody").append(e(this).data("row"));return false});e("#woocommerce-product-data").on("click",".downloadable_files a.delete",function(){e(this).closest("tr").remove();return false});e("input#_manage_stock").change(function(){if(e(this).is(":checked"))e("div.stock_fields").show();else e("div.stock_fields").hide()}).change();var r=e(".sale_price_dates_fields input").datepicker({defaultDate:"",dateFormat:"yy-mm-dd",numberOfMonths:1,showButtonPanel:true,showOn:"button",buttonImage:woocommerce_admin_meta_boxes.calendar_image,buttonImageOnly:true,onSelect:function(t){var n=e(this).is("#_sale_price_dates_from, .sale_price_dates_from")?"minDate":"maxDate";var i=e(this).data("datepicker"),s=e.datepicker.parseDate(i.settings.dateFormat||e.datepicker._defaults.dateFormat,t,i.settings);r.not(this).datepicker("option",n,s)}});e(".date-picker").datepicker({dateFormat:"yy-mm-dd",numberOfMonths:1,showButtonPanel:true,showOn:"button",buttonImage:woocommerce_admin_meta_boxes.calendar_image,buttonImageOnly:true});e(".date-picker-field").datepicker({dateFormat:"yy-mm-dd",numberOfMonths:1,showButtonPanel:true});jQuery(".wc-metaboxes-wrapper").on("click",".wc-metabox h3",function(t){if(e(t.target).filter(":input, option").length)return;jQuery(this).next(".wc-metabox-content").toggle()}).on("click",".expand_all",function(e){jQuery(this).closest(".wc-metaboxes-wrapper").find(".wc-metabox > table").show();return false}).on("click",".close_all",function(e){jQuery(this).closest(".wc-metaboxes-wrapper").find(".wc-metabox > table").hide();return false});jQuery(".wc-metabox.closed").each(function(){jQuery(this).find(".wc-metabox-content").hide()});e(".product_attributes select.multiselect").chosen();var i=e(".product_attributes").find(".woocommerce_attribute").get();i.sort(function(t,n){var r=parseInt(e(t).attr("rel"));var i=parseInt(e(n).attr("rel"));return r<i?-1:r>i?1:0});e(i).each(function(t,n){e(".product_attributes").append(n)});e("button.add_attribute").on("click",function(){var t=e(".product_attributes .woocommerce_attribute").size();var n=e("select.attribute_taxonomy").val();if(!n){var r=e("select#product-type").val();if(r!="variable")enable_variation='style="display:none;"';else enable_variation="";e(".product_attributes").append('<div class="woocommerce_attribute wc-metabox">						<h3>							<button type="button" class="remove_row button">'+woocommerce_admin_meta_boxes.remove_label+'</button>							<div class="handlediv" title="'+woocommerce_admin_meta_boxes.click_to_toggle+'"></div>							<strong class="attribute_name"></strong>						</h3>						<table cellpadding="0" cellspacing="0" class="woocommerce_attribute_data">							<tbody>								<tr>									<td class="attribute_name">										<label>'+woocommerce_admin_meta_boxes.name_label+':</label>										<input type="text" class="attribute_name" name="attribute_names['+t+']" />										<input type="hidden" name="attribute_is_taxonomy['+t+']" value="0" />										<input type="hidden" name="attribute_position['+t+']" class="attribute_position" value="'+t+'" />									</td>									<td rowspan="3">										<label>'+woocommerce_admin_meta_boxes.values_label+':</label>										<textarea name="attribute_values['+t+']" cols="5" rows="5" placeholder="'+woocommerce_admin_meta_boxes.text_attribute_tip+'"></textarea>									</td>								</tr>								<tr>									<td>										<label><input type="checkbox" class="checkbox" '+(woocommerce_admin_meta_boxes.default_attribute_visibility?'checked="checked"':"")+' name="attribute_visibility['+t+']" value="1" /> '+woocommerce_admin_meta_boxes.visible_label+'</label>									</td>								</tr>								<tr>									<td>										<div class="enable_variation show_if_variable" '+enable_variation+'>										<label><input type="checkbox" class="checkbox" '+(woocommerce_admin_meta_boxes.default_attribute_variation?'checked="checked"':"")+' name="attribute_variation['+t+']" value="1" /> '+woocommerce_admin_meta_boxes.used_for_variations_label+"</label>										</div>									</td>								</tr>							</tbody>						</table>					</div>")}else{var i=e(".product_attributes .woocommerce_attribute."+n);e(".product_attributes").append(e(i));e(i).show().find(".woocommerce_attribute_data").show();s()}e("select.attribute_taxonomy").val("")});e(".product_attributes").on("blur","input.attribute_name",function(){e(this).closest(".woocommerce_attribute").find("strong.attribute_name").text(e(this).val())});e(".product_attributes").on("click","button.select_all_attributes",function(){e(this).closest("td").find("select option").attr("selected","selected");e(this).closest("td").find("select").trigger("chosen:updated");return false});e(".product_attributes").on("click","button.select_no_attributes",function(){e(this).closest("td").find("select option").removeAttr("selected");e(this).closest("td").find("select").trigger("chosen:updated");return false});e(".product_attributes").on("click","button.remove_row",function(){var t=confirm(woocommerce_admin_meta_boxes.remove_attribute);if(t){var n=e(this).parent().parent();if(n.is(".taxonomy")){n.find("select, input[type=text]").val("");n.hide()}else{n.find("select, input[type=text]").val("");n.hide();s()}}return false});e(".product_attributes").sortable({items:".woocommerce_attribute",cursor:"move",axis:"y",handle:"h3",scrollSensitivity:40,forcePlaceholderSize:true,helper:"clone",opacity:.65,placeholder:"wc-metabox-sortable-placeholder",start:function(e,t){t.item.css("background-color","#f6f6f6")},stop:function(e,t){t.item.removeAttr("style");s()}});e(".product_attributes").on("click","button.add_new_attribute",function(){e(".product_attributes").block({message:null,overlayCSS:{background:"#fff url("+woocommerce_admin_meta_boxes.plugin_url+"/assets/images/ajax-loader.gif) no-repeat center",opacity:.6}});var t=e(this).attr("data-attribute");var n=e(this).closest(".woocommerce_attribute_data");var r=prompt(woocommerce_admin_meta_boxes.new_attribute_prompt);if(r){var i={action:"woocommerce_add_new_attribute",taxonomy:t,term:r,security:woocommerce_admin_meta_boxes.add_attribute_nonce};e.post(woocommerce_admin_meta_boxes.ajax_url,i,function(t){if(t.error){alert(t.error)}else if(t.slug){n.find("select.attribute_values").append('<option value="'+t.slug+'" selected="selected">'+t.name+"</option>");n.find("select.attribute_values").trigger("chosen:updated")}e(".product_attributes").unblock()})}else{e(".product_attributes").unblock()}return false});e(".save_attributes").on("click",function(){e(".product_attributes").block({message:null,overlayCSS:{background:"#fff url("+woocommerce_admin_meta_boxes.plugin_url+"/assets/images/ajax-loader.gif) no-repeat center",opacity:.6}});var t={post_id:woocommerce_admin_meta_boxes.post_id,data:e(".product_attributes").find("input, select, textarea").serialize(),action:"woocommerce_save_attributes",security:woocommerce_admin_meta_boxes.save_attributes_nonce};e.post(woocommerce_admin_meta_boxes.ajax_url,t,function(t){var n=window.location.toString();n=n.replace("post-new.php?","post.php?post="+woocommerce_admin_meta_boxes.post_id+"&action=edit&");e("#variable_product_options").block({message:null,overlayCSS:{background:"#fff url("+woocommerce_admin_meta_boxes.plugin_url+"/assets/images/ajax-loader.gif) no-repeat center",opacity:.6}});e("#variable_product_options").load(n+" #variable_product_options_inner",function(){e("#variable_product_options").unblock()});e(".product_attributes").unblock()})});var o;var u;jQuery(document).on("click",".upload_file_button",function(t){var n=e(this);u=n.closest("tr").find("td.file_url input");t.preventDefault();if(o){o.open();return}var r=[new wp.media.controller.Library({library:wp.media.query(),multiple:true,title:n.data("choose"),priority:20,filterable:"uploaded"})];o=wp.media.frames.downloadable_file=wp.media({title:n.data("choose"),library:{type:""},button:{text:n.data("update")},multiple:true,states:r});o.on("select",function(){var e="";var t=o.state().get("selection");t.map(function(t){t=t.toJSON();if(t.url)e=t.url});u.val(e)});o.on("ready",function(){o.uploader.options.uploader.params={type:"downloadable_product"}});o.open()});jQuery(".downloadable_files tbody").sortable({items:"tr",cursor:"move",axis:"y",handle:"td.sort",scrollSensitivity:40,forcePlaceholderSize:true,helper:"clone",opacity:.65});var a;var f=e("#product_image_gallery");var l=e("#product_images_container ul.product_images");jQuery(".add_product_images").on("click","a",function(t){var n=e(this);var r=f.val();t.preventDefault();if(a){a.open();return}a=wp.media.frames.product_gallery=wp.media({title:n.data("choose"),button:{text:n.data("update")},states:[new wp.media.controller.Library({title:n.data("choose"),filterable:"all",multiple:true})]});a.on("select",function(){var e=a.state().get("selection");e.map(function(e){e=e.toJSON();if(e.id){r=r?r+","+e.id:e.id;l.append('						<li class="image" data-attachment_id="'+e.id+'">							<img src="'+e.url+'" />							<ul class="actions">								<li><a href="#" class="delete" title="'+n.data("delete")+'">'+n.data("text")+"</a></li>							</ul>						</li>")}});f.val(r)});a.open()});l.sortable({items:"li.image",cursor:"move",scrollSensitivity:40,forcePlaceholderSize:true,forceHelperSize:false,helper:"clone",opacity:.65,placeholder:"wc-metabox-sortable-placeholder",start:function(e,t){t.item.css("background-color","#f6f6f6")},stop:function(e,t){t.item.removeAttr("style")},update:function(t,n){var r="";e("#product_images_container ul li.image").css("cursor","default").each(function(){var e=jQuery(this).attr("data-attachment_id");r=r+e+","});f.val(r)}});e("#product_images_container").on("click","a.delete",function(){e(this).closest("li.image").remove();var n="";e("#product_images_container ul li.image").css("cursor","default").each(function(){var e=jQuery(this).attr("data-attachment_id");n=n+e+","});f.val(n);t();return false})})