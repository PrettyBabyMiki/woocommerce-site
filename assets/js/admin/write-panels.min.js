jQuery(function(e){e("#upsell_product_data").bind("keypress",function(j){if(j.keyCode==13){return false}});e("ul.tabs").show();e("div.panel-wrap").each(function(){e("div.panel:not(div.panel:first)",this).hide()});e("ul.tabs a").click(function(){var j=e(this).closest("div.panel-wrap");e("ul.tabs li",j).removeClass("active");e(this).parent().addClass("active");e("div.panel",j).hide();e(e(this).attr("href")).show();return false});e("a.edit_address").click(function(){e(this).hide();e(this).closest(".order_data").find("div.address").hide();e(this).closest(".order_data").find("div.edit_address").show()});jQuery("select.chosen_select").chosen();jQuery("select.chosen_select_nostd").chosen({allow_single_deselect:"true"});e("#order_items_list button.remove_row").live("click",function(){var j=confirm(woocommerce_writepanel_params.remove_item_notice);if(j){e(this).closest("tr.item").hide();e("input",e(this).closest("tr.item")).val("")}return false});e("button.calc_totals").live("click",function(){var s=confirm(woocommerce_writepanel_params.cart_total);if(s){var k=e("#order_items_list tr.item").size();var q=0;var r=e("input#_order_discount").val();var j=e("input#_order_shipping").val();var m=parseFloat(e("input#_order_shipping_tax").val());var n=0;var l=0;var q=0;var p=0;var o=0;if(!r){r=0}if(!j){j=0}if(!m){m=0}if(k>0){for(i=0;i<k;i++){itemCost=e("input[name^=item_cost]:eq("+i+")").val();itemQty=parseInt(e("input[name^=item_quantity]:eq("+i+")").val());itemBase=e("input[name^=base_item_cost]:eq("+i+")").val();itemTax=e("input[name^=item_tax_rate]:eq("+i+")").val();if(!itemCost){itemCost=0}if(!itemTax){itemTax=0}if(!itemQty){itemQty=0}if(!itemBase){itemBase=0}totalItemTax=0;if(itemTax&&itemTax>0){if(woocommerce_writepanel_params.prices_include_tax=="yes"){taxRate=(itemTax/100)+1;itemDiscount=((itemBase*itemQty)*taxRate)-((itemCost*itemQty)*taxRate);totalItemTax=(itemCost*itemQty)*(itemTax/100);discounted_price=(itemCost*itemQty)*taxRate;if(woocommerce_writepanel_params.round_at_subtotal=="no"){totalItemTax=totalItemTax*100;totalItemTax=totalItemTax.toFixed(2);totalItemTax=Math.round(totalItemTax)/100}}else{taxRate=(itemTax/100);itemDiscount=(itemBase*itemQty)-(itemCost*itemQty);totalItemTax=(itemCost*itemQty)*taxRate;discounted_price=(itemCost*itemQty)+totalItemTax;if(woocommerce_writepanel_params.round_at_subtotal=="no"){totalItemTax=totalItemTax*100;totalItemTax=totalItemTax.toFixed(2);totalItemTax=Math.round(totalItemTax)/100}}}else{itemDiscount=(itemBase*itemQty)-(itemCost*itemQty);discounted_price=(itemCost*itemQty)}q=q+parseFloat((itemBase*itemQty));o=o+parseFloat(itemDiscount);totalItemCost=parseFloat(discounted_price);l=l+parseFloat(totalItemCost);n=n+parseFloat(totalItemTax)}}if(woocommerce_writepanel_params.round_at_subtotal=="yes"){n=n*100;n=n.toFixed(2);n=Math.round(n)/100}p=parseFloat(l)-parseFloat(r)+parseFloat(j)+parseFloat(m);q=q*100;q=q.toFixed(2);q=Math.round(q)/100;p=p*100;p=p.toFixed(2);p=Math.round(p)/100;if(p<0){p=0}e("input#_cart_discount").val(o.toFixed(2));e("input#_order_subtotal").val(q.toFixed(2));e("input#_order_tax").val(n.toFixed(2));e("input#_order_shipping_tax").val(m.toFixed(2));e("input#_order_total").val(p.toFixed(2))}return false});e("button.add_shop_order_item").click(function(){var l=e("select.add_item_id").val();if(l){e("table.woocommerce_order_items").block({message:null,overlayCSS:{background:"#fff url("+woocommerce_writepanel_params.plugin_url+"/assets/images/ajax-loader.gif) no-repeat center",opacity:0.6}});var j=e("table.woocommerce_order_items tbody tr.item").size();var k={action:"woocommerce_add_order_item",item_to_add:e("select.add_item_id").val(),index:j,security:woocommerce_writepanel_params.add_order_item_nonce};e.post(woocommerce_writepanel_params.ajax_url,k,function(m){e("table.woocommerce_order_items tbody#order_items_list").append(m);e("table.woocommerce_order_items").unblock();e("select.add_item_id").css("border-color","").val("");jQuery(".tips").tipTip({attribute:"tip",fadeIn:50,fadeOut:50})})}else{e("select.add_item_id").css("border-color","red")}});e("button.add_meta").live("click",function(){var j=e(this).closest("tr.item").attr("rel");e(this).closest("table.meta").find(".meta_items").append('<tr><td><input type="text" name="meta_name['+j+'][]" placeholder="'+woocommerce_writepanel_params.meta_name+'" /></td><td><input type="text" name="meta_value['+j+'][]" placeholder="'+woocommerce_writepanel_params.meta_value+'" /></td><td><button class="remove_meta button">&times;</button></td></tr>');return false});e("button.remove_meta").live("click",function(){var j=confirm("Remove this meta key?");if(j){e(this).closest("tr").remove()}return false});e("button.load_customer_billing").live("click",function(){var l=confirm(woocommerce_writepanel_params.load_billing);if(l){var j=e("#customer_user").val();if(!j){alert(woocommerce_writepanel_params.no_customer_selected);return false}var k={user_id:j,type_to_load:"billing",action:"woocommerce_get_customer_details",security:woocommerce_writepanel_params.get_customer_details_nonce};e(this).closest(".edit_address").block({message:null,overlayCSS:{background:"#fff url("+woocommerce_writepanel_params.plugin_url+"/assets/images/ajax-loader.gif) no-repeat center",opacity:0.6}});e.ajax({url:woocommerce_writepanel_params.ajax_url,data:k,type:"POST",success:function(m){var n=jQuery.parseJSON(m);if(n){e("input#_billing_first_name").val(n.billing_first_name);e("input#_billing_last_name").val(n.billing_last_name);e("input#_billing_company").val(n.billing_company);e("input#_billing_address_1").val(n.billing_address_1);e("input#_billing_address_2").val(n.billing_address_2);e("input#_billing_city").val(n.billing_city);e("input#_billing_postcode").val(n.billing_postcode);e("input#_billing_country").val(n.billing_country);e("input#_billing_state").val(n.billing_state);e("input#_billing_email").val(n.billing_email);e("input#_billing_phone").val(n.billing_phone)}e(".edit_address").unblock()}})}return false});e("button.load_customer_shipping").live("click",function(){var l=confirm(woocommerce_writepanel_params.load_shipping);if(l){var j=e("#customer_user").val();if(!j){alert(woocommerce_writepanel_params.no_customer_selected);return false}var k={user_id:j,type_to_load:"shipping",action:"woocommerce_get_customer_details",security:woocommerce_writepanel_params.get_customer_details_nonce};e(this).closest(".edit_address").block({message:null,overlayCSS:{background:"#fff url("+woocommerce_writepanel_params.plugin_url+"/assets/images/ajax-loader.gif) no-repeat center",opacity:0.6}});e.ajax({url:woocommerce_writepanel_params.ajax_url,data:k,type:"POST",success:function(m){var n=jQuery.parseJSON(m);if(n){e("input#_shipping_first_name").val(n.shipping_first_name);e("input#_shipping_last_name").val(n.shipping_last_name);e("input#_shipping_company").val(n.shipping_company);e("input#_shipping_address_1").val(n.shipping_address_1);e("input#_shipping_address_2").val(n.shipping_address_2);e("input#_shipping_city").val(n.shipping_city);e("input#_shipping_postcode").val(n.shipping_postcode);e("input#_shipping_country").val(n.shipping_country);e("input#_shipping_state").val(n.shipping_state)}e(".edit_address").unblock()}})}return false});e("button.billing-same-as-shipping").live("click",function(){var j=confirm(woocommerce_writepanel_params.copy_billing);if(j){e("input#_shipping_first_name").val(e("input#_billing_first_name").val());e("input#_shipping_last_name").val(e("input#_billing_last_name").val());e("input#_shipping_company").val(e("input#_billing_company").val());e("input#_shipping_address_1").val(e("input#_billing_address_1").val());e("input#_shipping_address_2").val(e("input#_billing_address_2").val());e("input#_shipping_city").val(e("input#_billing_city").val());e("input#_shipping_postcode").val(e("input#_billing_postcode").val());e("input#_shipping_country").val(e("input#_billing_country").val());e("input#_shipping_state").val(e("input#_billing_state").val())}return false});e("select#product-type").change(function(){var j=e(this).val();e(".show_if_simple, .show_if_variable, .show_if_grouped, .show_if_external").hide();if(j=="simple"){e(".show_if_simple").show();e("input#manage_stock").change()}else{if(j=="variable"){e(".show_if_variable").show();e("input#manage_stock").change();e("input#downloadable").prop("checked",false).change();e("input#virtual").removeAttr("checked").change()}else{if(j=="grouped"){e(".show_if_grouped").show();e("input#downloadable").prop("checked",false).change();e("input#virtual").removeAttr("checked").change()}else{if(j=="external"){e(".show_if_external").show();e("input#downloadable").prop("checked",false).change();e("input#virtual").removeAttr("checked").change()}}}}e("ul.tabs li:visible").eq(0).find("a").click();e("body").trigger("woocommerce-product-type-change",j,e(this))}).change();e("input#downloadable").change(function(){e(".show_if_downloadable").hide();if(e("input#downloadable").is(":checked")){e(".show_if_downloadable").show()}if(e(".downloads_tab").is(".active")){e("ul.tabs li:visible").eq(0).find("a").click()}}).change();e("input#virtual").change(function(){e(".show_if_virtual").hide();e(".hide_if_virtual").show();if(e("input#virtual").is(":checked")){e(".show_if_virtual").show();e(".hide_if_virtual").hide()}}).change();var h=false;e(".sale_price_dates_fields input").each(function(){if(e(this).val()!=""){h=true}});if(h){e(".sale_schedule").hide();e(".sale_price_dates_fields").show()}else{e(".sale_schedule").show();e(".sale_price_dates_fields").hide()}e(".sale_schedule").click(function(){e(this).hide();e(".sale_price_dates_fields").show();return false});e(".cancel_sale_schedule").click(function(){e(this).closest("p").find("input").val("");e(".sale_schedule").show();e(".sale_price_dates_fields").hide();return false});e("input#manage_stock").change(function(){if(e(this).is(":checked")){e("div.stock_fields").show()}else{e("div.stock_fields").hide()}}).change();var f=e("#sale_price_dates_from, #sale_price_dates_to").datepicker({defaultDate:"",dateFormat:"yy-mm-dd",numberOfMonths:1,showButtonPanel:true,showOn:"button",buttonImage:woocommerce_writepanel_params.calendar_image,buttonImageOnly:true,onSelect:function(l){var m=this.id=="sale_price_dates_from"?"minDate":"maxDate",j=e(this).data("datepicker"),k=e.datepicker.parseDate(j.settings.dateFormat||e.datepicker._defaults.dateFormat,l,j.settings);f.not(this).datepicker("option",m,k)}});e(".date-picker").datepicker({dateFormat:"yy-mm-dd",numberOfMonths:1,showButtonPanel:true,showOn:"button",buttonImage:woocommerce_writepanel_params.calendar_image,buttonImageOnly:true});e("#attributes_list select.multiselect").chosen();var d=e("#attributes_list").children("tr").get();d.sort(function(k,j){var m=e(k).attr("rel");var l=e(j).attr("rel");return(m<l)?-1:(m>l)?1:0});e(d).each(function(j,k){e("#attributes_list").append(k)});function b(){e("table.woocommerce_attributes, table.woocommerce_variable_attributes").each(function(){if(e("tbody tr",this).size()==0){e(this).parent().hide()}else{e(this).parent().show()}})}b();function c(){e("#attributes_list tr").each(function(j,k){e(".attribute_position",k).val(parseInt(e(k).index("#attributes_list tr")))})}e("button.add_attribute").click(function(){var k=e("table.woocommerce_attributes tbody tr").size();var l=e("select.attribute_taxonomy").val();if(!l){var m=e("select#product-type").val();if(m!="variable"){enable_variation='style="display:none;"'}else{enable_variation=""}e("table.woocommerce_attributes tbody").append('<tr><td class="handle"></td><td><input type="text" name="attribute_names['+k+']" /><input type="hidden" name="attribute_is_taxonomy['+k+']" value="0" /><input type="hidden" name="attribute_position['+k+']" class="attribute_position" value="'+k+'" /></td><td><input type="text" name="attribute_values['+k+']" /></td><td class="center"><input type="checkbox" checked="checked" name="attribute_visibility['+k+']" value="1" /></td><td class="center enable_variation" '+enable_variation+'><input type="checkbox" name="attribute_variation['+k+']" value="1" /></td><td class="center"><button type="button" class="remove_row button">&times;</button></td></tr>')}else{var j=e("table.woocommerce_attributes tbody tr."+l);e("table.woocommerce_attributes tbody").append(e(j));e(j).show();c()}b()});e("button.hide_row").live("click",function(){var j=confirm("Remove this attribute?");if(j){e(this).parent().parent().find("select, input[type=text]").val("");e(this).parent().parent().hide();b()}return false});e("#attributes_list button.remove_row").live("click",function(){var j=confirm("Remove this attribute?");if(j){e(this).parent().parent().remove();b();c()}return false});e("table.woocommerce_attributes tbody").sortable({items:"tr",cursor:"move",axis:"y",handle:".handle",scrollSensitivity:40,helper:function(k,j){j.children().each(function(){e(this).width(e(this).width())});j.css("left","0");return j},start:function(j,k){k.item.css("background-color","#f6f6f6")},stop:function(j,k){k.item.removeAttr("style");c()}});e(".multi_select_products button").live("click",function(){var p=e(this).parent().parent().parent().parent();var j=e(this);var l=j.parent().parent();if(l.is(".multi_select_products_target_upsell")||l.is(".multi_select_products_target_crosssell")){j.parent().remove()}else{if(j.is(".add_upsell")){var n=e(".multi_select_products_target_upsell",e(p));var o="upsell_ids[]"}else{var n=e(".multi_select_products_target_crosssell",e(p));var o="crosssell_ids[]"}var k=e("li[rel="+j.parent().attr("rel")+"]",n);if(e(k).size()>0){return false}var m=j.parent().clone();m.find("button:eq(0)").html("&times;");m.find("button:eq(1)").remove();m.find("input").val(j.parent().attr("rel"));m.find(".product_id").attr("name",o);m.appendTo(n)}});var g;e(".multi_select_products #product_search").bind("keyup click",function(){e(".multi_select_products_source").addClass("loading");e(".multi_select_products_source li:not(.product_search)").remove();if(g){g.abort()}var l=e(this).val();var j=this;var k=e(this).attr("rel");if(l.length<3){e(".multi_select_products_source").removeClass("loading");return}var m={name:k,search:encodeURI(l),action:"woocommerce_upsell_crosssell_search_products",security:woocommerce_writepanel_params.upsell_crosssell_search_products_nonce};g=e.ajax({url:woocommerce_writepanel_params.ajax_url,data:m,type:"POST",success:function(n){e(".multi_select_products_source").removeClass("loading");e(".multi_select_products_source li:not(.product_search)").remove();e(j).parent().parent().append(n)}})});var a;window.send_to_editor_default=window.send_to_editor;jQuery(".upload_file_button").live("click",function(){a=jQuery(this).parent().find(".file_path");formfield=jQuery(a).attr("name");window.send_to_editor=window.send_to_download_url;tb_show("","media-upload.php?post_id="+woocommerce_writepanel_params.post_id+"&amp;type=downloadable_product&amp;from=wc01&amp;TB_iframe=true");return false});window.send_to_download_url=function(j){file_url=jQuery(j).attr("href");if(file_url){jQuery(a).val(file_url)}tb_remove();window.send_to_editor=window.send_to_editor_default}});