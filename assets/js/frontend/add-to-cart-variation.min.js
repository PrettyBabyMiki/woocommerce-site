/*!
 * Variations Plugin
 */
!function(a,b,c,d){a.fn.wc_variation_form=function(){var b=this,c=b.closest(".product"),f=parseInt(b.data("product_id")),g=b.data("product_variations"),h=g===!1,i=!1,j=b.find(".reset_variations");return b.unbind("check_variations update_variation_values found_variation"),b.find(".reset_variations").unbind("click"),b.find(".variations select").unbind("change focusin"),b.on("click",".reset_variations",function(){return b.find(".variations select").val("").change(),b.triggerHandler("reset_data"),!1}).on("reset_data",function(){var d={".sku":"o_sku",".product_weight":"o_weight",".product_dimensions":"o_dimensions"};a.each(d,function(a,b){var d=c.find(a);d.attr("data-"+b)&&d.text(d.attr("data-"+b))}),b.find(".woocommerce-variation-description").remove(),b.triggerHandler("reset_image"),b.find(".single_variation_wrap").slideUp(200).triggerHandler("hide_variation")}).on("reset_image",function(){var a=c.find("div.images img:eq(0)"),b=c.find("div.images a.zoom:eq(0)"),e=a.attr("data-o_src"),f=a.attr("data-o_title"),g=a.attr("data-o_title"),h=b.attr("data-o_href");e!==d&&a.attr("src",e),h!==d&&b.attr("href",h),f!==d&&(a.attr("title",f),b.attr("title",f)),g!==d&&a.attr("alt",g)}).on("change",".variations select",function(){if(b.find('input[name="variation_id"], input.variation_id').val("").change(),b.find(".wc-no-matching-variations").remove(),h){i&&i.abort();var c=!0,d=!1,e={};b.find(".variations select").each(function(){var b=a(this).data("attribute_name")||a(this).attr("name");0===a(this).val().length?c=!1:d=!0,e[b]=a(this).val()}),c?(e.product_id=f,i=a.ajax({url:wc_cart_fragments_params.wc_ajax_url+"get_variation/",type:"POST",data:e,success:function(a){a?(b.find('input[name="variation_id"], input.variation_id').val(a.variation_id).change(),b.triggerHandler("found_variation",[a])):(b.triggerHandler("reset_data"),b.find(".single_variation_wrap").after('<p class="wc-no-matching-variations woocommerce-info">'+wc_add_to_cart_variation_params.i18n_no_matching_variations_text+"</p>"),b.find(".wc-no-matching-variations").slideDown(200))}})):b.triggerHandler("reset_data"),d?"hidden"===j.css("visibility")&&j.css("visibility","visible").hide().fadeIn():j.css("visibility","hidden")}else b.triggerHandler("woocommerce_variation_select_change"),b.triggerHandler("check_variations",["",!1]),a(this).blur();b.triggerHandler("woocommerce_variation_has_changed")}).on("focusin touchstart",".variations select",function(){h||(b.triggerHandler("woocommerce_variation_select_focusin"),b.triggerHandler("check_variations",[a(this).data("attribute_name")||a(this).attr("name"),!0]))}).on("found_variation",function(a,e){{var f=c.find("div.images img:eq(0)"),g=c.find("div.images a.zoom:eq(0)"),h=f.attr("data-o_src"),i=f.attr("data-o_title"),j=f.attr("data-o_alt"),k=g.attr("data-o_href"),l=e.image_src,m=e.image_link,n=e.image_caption,o=e.image_title;e.image_alt}b.find(".variations_button").show(),b.find(".single_variation").html(e.price_html+e.availability_html),h===d&&(h=f.attr("src")?f.attr("src"):"",f.attr("data-o_src",h)),k===d&&(k=g.attr("href")?g.attr("href"):"",g.attr("data-o_href",k)),i===d&&(i=f.attr("title")?f.attr("title"):"",f.attr("data-o_title",i)),j===d&&(j=f.attr("alt")?f.attr("alt"):"",f.attr("data-o_alt",j)),l&&l.length>1?(f.attr("src",l).attr("alt",o).attr("title",o),g.attr("href",m).attr("title",n)):(f.attr("src",h).attr("alt",j).attr("title",i),g.attr("href",k).attr("title",i));var p=b.find(".single_variation_wrap"),q=c.find(".product_meta").find(".sku"),r=c.find(".product_weight"),s=c.find(".product_dimensions");q.attr("data-o_sku")||q.attr("data-o_sku",q.text()),r.attr("data-o_weight")||r.attr("data-o_weight",r.text()),s.attr("data-o_dimensions")||s.attr("data-o_dimensions",s.text()),q.text(e.sku?e.sku:q.attr("data-o_sku")),r.text(e.weight?e.weight:r.attr("data-o_weight")),s.text(e.dimensions?e.dimensions:s.attr("data-o_dimensions")),p.find(".quantity").show(),e.is_purchasable&&e.is_in_stock&&e.variation_is_visible||b.find(".variations_button").hide(),e.variation_is_visible||b.find(".single_variation").html("<p>"+wc_add_to_cart_variation_params.i18n_unavailable_text+"</p>"),""!==e.min_qty?p.find(".quantity input.qty").attr("min",e.min_qty).val(e.min_qty):p.find(".quantity input.qty").removeAttr("min"),""!==e.max_qty?p.find(".quantity input.qty").attr("max",e.max_qty):p.find(".quantity input.qty").removeAttr("max"),"yes"===e.is_sold_individually&&(p.find(".quantity input.qty").val("1"),p.find(".quantity").hide()),b.find(".woocommerce-variation-description").remove(),e.variation_description&&b.find(".single_variation_wrap").prepend('<div class="woocommerce-variation-description">'+e.variation_description+"</div>"),p.slideDown(200).triggerHandler("show_variation",[e])}).on("check_variations",function(b,c,d){if(!h){var f=!0,i=!1,j={},k=a(this),l=k.find(".reset_variations");k.find(".variations select").each(function(){var b=a(this).data("attribute_name")||a(this).attr("name");0===a(this).val().length?f=!1:i=!0,c&&b===c?(f=!1,j[b]=""):j[b]=a(this).val()});var m=e.find_matching_variations(g,j);if(f){var n=m.shift();n?(k.find('input[name="variation_id"], input.variation_id').val(n.variation_id).change(),k.triggerHandler("found_variation",[n])):(k.find(".variations select").val(""),d||k.triggerHandler("reset_data"),alert(wc_add_to_cart_variation_params.i18n_no_matching_variations_text))}else k.triggerHandler("update_variation_values",[m]),d||k.triggerHandler("reset_data"),c||k.find(".single_variation_wrap").slideUp(200).triggerHandler("hide_variation");i?"hidden"===l.css("visibility")&&l.css("visibility","visible").hide().fadeIn():l.css("visibility","hidden")}}).on("update_variation_values",function(c,d){h||(b.find(".variations select").each(function(b,c){current_attr_select=a(c),current_attr_select.data("attribute_options")||current_attr_select.data("attribute_options",current_attr_select.find("option:gt(0)").get()),current_attr_select.find("option:gt(0)").remove(),current_attr_select.append(current_attr_select.data("attribute_options")),current_attr_select.find("option:gt(0)").removeClass("attached"),current_attr_select.find("option:gt(0)").removeClass("enabled"),current_attr_select.find("option:gt(0)").removeAttr("disabled"),current_attr_name="undefined"!=typeof current_attr_select.data("attribute_name")?current_attr_select.data("attribute_name"):current_attr_select.attr("name");for(var e in d)if("undefined"!=typeof d[e]){var f=d[e].attributes;for(var g in f)if(f.hasOwnProperty(g)){var h=f[g];g==current_attr_name&&(variation_active=d[e].variation_is_active?"enabled":"",h?(h=a("<div/>").html(h).text(),h=h.replace(/'/g,"\\'"),h=h.replace(/"/g,'\\"'),current_attr_select.find('option[value="'+h+'"]').addClass("attached "+variation_active)):current_attr_select.find("option:gt(0)").addClass("attached "+variation_active))}}current_attr_select.find("option:gt(0):not(.attached)").remove(),current_attr_select.find("option:gt(0):not(.enabled)").attr("disabled","disabled")}),b.triggerHandler("woocommerce_update_variation_values"))}),b.triggerHandler("wc_variation_form"),b};var e={find_matching_variations:function(a,b){for(var c=[],d=0;d<a.length;d++){{var f=a[d];f.variation_id}e.variations_match(f.attributes,b)&&c.push(f)}return c},variations_match:function(a,b){var c=!0;for(var e in a)if(a.hasOwnProperty(e)){var f=a[e],g=b[e];f!==d&&g!==d&&0!==f.length&&0!==g.length&&f!==g&&(c=!1)}return c}};a(function(){"undefined"!=typeof wc_add_to_cart_variation_params&&a(".variations_form").each(function(){a(this).wc_variation_form().find(".variations select:eq(0)").change()})})}(jQuery,window,document);